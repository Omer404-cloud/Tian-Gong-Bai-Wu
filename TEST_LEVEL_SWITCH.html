<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å…³å¡åˆ‡æ¢æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 600px;
            margin: 0 auto;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background: #4CAF50;
            color: white;
        }
        button:hover {
            background: #45a049;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            background: #e8f5e9;
            border-left: 4px solid #4CAF50;
        }
        .error {
            background: #ffebee;
            border-left-color: #f44336;
        }
        h2 {
            color: #333;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” å…³å¡åˆ‡æ¢æµ‹è¯•å·¥å…·</h1>
        <p>æ­¤å·¥å…·ç”¨äºæµ‹è¯•å…³å¡åˆ‡æ¢é€»è¾‘æ˜¯å¦æ­£ç¡®ã€‚</p>
        
        <h2>å½“å‰çŠ¶æ€</h2>
        <div id="currentStatus" class="result">
            <div>å½“å‰å…³å¡: <strong id="currentLevel">1</strong></div>
            <div>å…³å¡åç§°: <strong id="levelName">è€’ï¼ˆlÄ›iï¼‰</strong></div>
        </div>
        
        <h2>æµ‹è¯•æ“ä½œ</h2>
        <button onclick="simulateLevel1Complete()">âœ… æ¨¡æ‹Ÿç¬¬ä¸€å…³é€šå…³</button>
        <button onclick="simulateLevel2Complete()">âœ… æ¨¡æ‹Ÿç¬¬äºŒå…³é€šå…³</button>
        <button onclick="simulateLevel3Complete()">âœ… æ¨¡æ‹Ÿç¬¬ä¸‰å…³é€šå…³</button>
        <button onclick="resetTest()">ğŸ”„ é‡ç½®æµ‹è¯•</button>
        
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="testResults"></div>
        
        <h2>è°ƒè¯•ä¿¡æ¯</h2>
        <div id="debugInfo" style="background:#f9f9f9;padding:10px;border-radius:5px;font-family:monospace;font-size:12px;max-height:300px;overflow-y:auto;"></div>
    </div>
    
    <script src="script.js"></script>
    <script>
        let testGame;
        
        function log(message, isError = false) {
            const debugInfo = document.getElementById('debugInfo');
            const timestamp = new Date().toLocaleTimeString();
            const className = isError ? 'error' : 'result';
            debugInfo.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            debugInfo.scrollTop = debugInfo.scrollHeight;
        }
        
        function updateStatus() {
            if (!testGame) return;
            document.getElementById('currentLevel').textContent = testGame.level;
            document.getElementById('levelName').textContent = testGame.elementNames[testGame.level] || testGame.level;
        }
        
        function addResult(message, success = true) {
            const results = document.getElementById('testResults');
            const className = success ? 'result' : 'result error';
            results.innerHTML += `<div class="${className}">${success ? 'âœ…' : 'âŒ'} ${message}</div>`;
        }
        
        function simulateLevel1Complete() {
            log('å¼€å§‹æ¨¡æ‹Ÿç¬¬ä¸€å…³é€šå…³...');
            if (!testGame) {
                testGame = new TetrisGame();
                log('æ¸¸æˆå®ä¾‹å·²åˆ›å»º');
            }
            
            log(`é€šå…³å‰ - å½“å‰å…³å¡: ${testGame.level}`);
            
            // æ¨¡æ‹Ÿé€šå…³ï¼šè®¾ç½®å®ŒæˆçŠ¶æ€
            testGame.level = 1;
            testGame.level1Data.completed = [];
            for (let i = 0; i < 11; i++) {
                testGame.level1Data.completed.push({
                    index: i,
                    object: true,
                    feature: true,
                    value: true
                });
            }
            
            log(`æ¨¡æ‹Ÿæ•°æ®è®¾ç½®å®Œæˆ - completedæ•°é‡: ${testGame.level1Data.completed.length}`);
            
            // è°ƒç”¨ä¸‹ä¸€å…³æ–¹æ³•
            testGame.goToNextLevel();
            
            log(`åˆ‡æ¢å - å½“å‰å…³å¡: ${testGame.level}`);
            log(`åˆ‡æ¢å - å…³å¡åç§°: ${testGame.elementNames[testGame.level]}`);
            log(`åˆ‡æ¢å - level2Dataä¸‰å…ƒç»„æ•°é‡: ${testGame.level2Data.triples.length}`);
            
            updateStatus();
            
            if (testGame.level === 2 && testGame.elementNames[testGame.level] === 'è€œï¼ˆsÃ¬ï¼‰') {
                addResult('ç¬¬ä¸€å…³é€šå…³åæˆåŠŸè·³è½¬åˆ°ç¬¬äºŒå…³ï¼', true);
                log('âœ… æµ‹è¯•é€šè¿‡ï¼šç¬¬ä¸€å…³ â†’ ç¬¬äºŒå…³', false);
            } else {
                addResult(`ç¬¬ä¸€å…³é€šå…³åè·³è½¬å¤±è´¥ï¼å½“å‰å…³å¡: ${testGame.level}`, false);
                log(`âŒ æµ‹è¯•å¤±è´¥ï¼šæœŸæœ›level=2ï¼Œå®é™…level=${testGame.level}`, true);
            }
        }
        
        function simulateLevel2Complete() {
            log('å¼€å§‹æ¨¡æ‹Ÿç¬¬äºŒå…³é€šå…³...');
            if (!testGame || testGame.level !== 2) {
                log('âŒ è¯·å…ˆæ¨¡æ‹Ÿç¬¬ä¸€å…³é€šå…³', true);
                addResult('è¯·å…ˆæ¨¡æ‹Ÿç¬¬ä¸€å…³é€šå…³', false);
                return;
            }
            
            log(`é€šå…³å‰ - å½“å‰å…³å¡: ${testGame.level}`);
            
            // æ¨¡æ‹Ÿé€šå…³
            testGame.level2Data.completed = [];
            for (let i = 0; i < 16; i++) {
                testGame.level2Data.completed.push({
                    index: i,
                    object: true,
                    feature: true,
                    value: true
                });
            }
            
            testGame.goToNextLevel();
            
            log(`åˆ‡æ¢å - å½“å‰å…³å¡: ${testGame.level}`);
            log(`åˆ‡æ¢å - å…³å¡åç§°: ${testGame.elementNames[testGame.level]}`);
            
            updateStatus();
            
            if (testGame.level === 3 && testGame.elementNames[testGame.level] === 'çŠï¼ˆlÃ­ï¼‰') {
                addResult('ç¬¬äºŒå…³é€šå…³åæˆåŠŸè·³è½¬åˆ°ç¬¬ä¸‰å…³ï¼', true);
                log('âœ… æµ‹è¯•é€šè¿‡ï¼šç¬¬äºŒå…³ â†’ ç¬¬ä¸‰å…³', false);
            } else {
                addResult(`ç¬¬äºŒå…³é€šå…³åè·³è½¬å¤±è´¥ï¼å½“å‰å…³å¡: ${testGame.level}`, false);
                log(`âŒ æµ‹è¯•å¤±è´¥ï¼šæœŸæœ›level=3ï¼Œå®é™…level=${testGame.level}`, true);
            }
        }
        
        function simulateLevel3Complete() {
            log('å¼€å§‹æ¨¡æ‹Ÿç¬¬ä¸‰å…³é€šå…³...');
            if (!testGame || testGame.level !== 3) {
                log('âŒ è¯·å…ˆæ¨¡æ‹Ÿå‰ä¸¤å…³é€šå…³', true);
                addResult('è¯·å…ˆæ¨¡æ‹Ÿå‰ä¸¤å…³é€šå…³', false);
                return;
            }
            
            log(`é€šå…³å‰ - å½“å‰å…³å¡: ${testGame.level}`);
            log('ç¬¬ä¸‰å…³æ˜¯æœ€åä¸€å…³ï¼Œé€šå…³ååº”è¯¥æ˜¾ç¤ºæœ€ç»ˆé€šå…³æç¤º');
            addResult('ç¬¬ä¸‰å…³æµ‹è¯•å®Œæˆ', true);
        }
        
        function resetTest() {
            log('é‡ç½®æµ‹è¯•...');
            testGame = null;
            document.getElementById('testResults').innerHTML = '';
            document.getElementById('currentLevel').textContent = '1';
            document.getElementById('levelName').textContent = 'è€’ï¼ˆlÄ›iï¼‰';
            log('æµ‹è¯•å·²é‡ç½®');
        }
        
        // é¡µé¢åŠ è½½æ—¶çš„æç¤º
        window.addEventListener('DOMContentLoaded', () => {
            log('=== å…³å¡åˆ‡æ¢æµ‹è¯•å·¥å…·å·²å°±ç»ª ===');
            log('ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•');
        });
    </script>
</body>
</html>
